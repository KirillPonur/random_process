\input{text/diss}
\begin{document}
\def\labauthors{Виноградов И.Д., Карусевич А.А., Понур К.А., Шиков А.П.}
\def\labgroup{440}
\def\labnumber{1}
\def\labtheme{Оценивание параметров случайного процесса}
\def\department{Кафедра статистической радиофизики}
\newcommand{\D}[1]{D\qty[#1]}
\input{text/titlepage}
\newpage
В настоящей работе изучаются вопросы, связанные с оценкой параметров случайных процессов, на примере оценки его среднего значения (математического ожидания). Это вполне оправданно, поскольку, во-первых, все принципиальные вопросы, возникающие при оценке параметров случайных процессов, проявляются уже в этой задаче. Во-вторых, при желании оценить другие параметры процесса чаще всего поступают следующим образом – подвергают случайный процесс такому преобразованию, при котором информация об интересующем параметре исходного процесса переходит в значение математического ожидания процесса преобразованного, и таким образом вопрос оказывается сведенным к оценке среднего значения преобразованного процесса.
Вопросы, связанные с оценкой параметров эргодических случайных процессов достаточно подробно рассмотрены в учебном пособии, с которым необходимо познакомиться перед выполнением настоящей работы.

При оценке того или иного параметра случайного процесса следует:
\begin{enumerate}
    \item Выбрать алгоритм оценки параметра (записать формулу, которая показывает, какие действия нужно производить с числами $x_{1},x_{2},\dots,x_n$ -- результатами измерений), чтобы получить число, принимаемое нами за оценку интересующего нас параметра.
    \item Исследовать выбранный алгоритм на предмет качества оценок. Качество оценки характеризуют ее \textbf{несмещенность}, \textbf{состоятельность} и \textbf{эффективность}:
    \begin{enumerate}
        \item Оценка называется \textbf{несмещенной}, если среднее статистическое её равно оцениваемой величине:  $\mean{\tilde a} = a$, где $a$ -- измеряемый параметр случайного процесса,  - его оценка\footnote{Оценка неизвестного параметра $a$ одним числом называется точечной}. Несмещенность оценки эквивалентна отсутствию систематической ошибки при измерении как в сторону ее завышения, так и в сторону ее занижения.
    \item Оценка называется состоятельной, если при неограниченном росте объёма экспериментального материала дисперсия оценки стремится к нулю. При этом вероятность сколь угодно малых отклонений оценки от оцениваемой величины тоже стремится к нулю. Таким образом, если оценка состоятельна, то можно быть уверенным, что величина ошибки измерения не превосходит допустимую при достаточно большом, но ограниченном объеме статистического материала (т.е. достаточно большом времени измерения).
    \item Если при измерении одной и той же характеристики случайного процесса можно пользоваться различными оценками, то эффективной называют оценку с наименьшей дисперсией. На практике не всегда удаётся удовлетворить всем этим требованиям. Например, может оказаться, что эффективная оценка существует, но формулы для её вычисления слишком сложны. Тогда приходится довольствоваться другой оценкой с несколько большей дисперсией. Иногда, в целях упрощения расчетов, применяются смещенные оценки. Но всегда выбору оценки должно предшествовать критическое изучение ее свойств.
    \end{enumerate}
\item Определить погрешность оценки параметра. 
\end{enumerate}
\section{Алгоритм оценки среднего значения}%
\label{sec:algoritm_otsenki_srednego_znacheniia}
Пусть мы имеем дело со случайной величиной $X$ и хотим найти её математическое ожидание.
Алгоритм оценки среднего значения выбирается в виде:
\begin{equation}
    \label{eq:1.1}
    \tilde x = \frac{1}{n} \sum\limits_{i=1}^{n} x_i \text{ для случайной величины)},
\end{equation}
где $x_i,~x_k$ -- результаты независимых измерений случайной величины;
\begin{equation}
    \label{eq:1.2}
    \tilde x = \frac{1}{n} \sum\limits_{i=1}^{n} x_i(t_i) \text{ (для случайного процесса)},
\end{equation}
где $x_i(t_i)$ -- дискретные выборки значений процесса $x(t)$, взятые в дискретные,
равноотстоящие на величину $\Delta t$, моменты времени ($\Delta t = t_{i+1}-t_i$ ).
Этот алгоритм оценки естественен, поскольку известно, что $\frac{1}{n} \sum\limits_{i=1}^{n} x_i$-- среднеарифметическое $n$ независимых измерений случайной
величины -- сходится по вероятности к среднему значению $\mean{x}^2$ (математическому
ожиданию) при $n \to \infty $.

Нетрудно показать, что оценки среднего \eqref{eq:1.1}, \eqref{eq:1.2}  являются
\textbf{несмещенными} (т.е. не содержат систематической ошибки). Действительно, проводя
статистическое усреднение левых и правых частей и учитывая эргодичность изучаемого
случайного процесса, получаем $\mean{\tilde x} = \mean{x}$, т.е. статистическое среднее оценок равно среднему
статистическому самого процесса.

При получении оценки среднего значения стационарного эргодического процесса согласно 
\eqref{eq:1.2}, усредняются дискретные выборочные значения процесса, отстоящие во времени 
на $\Delta t$. Возникает закономерный вопрос, не проигрываем ли мы в чем то существенном,
не используя информацию о процессе, заключающуюся в промежуточных значениях процесса,
лежащих между дискретными отсчетами. Может быть, оценка среднего существенно улучшится,
если взять ее в виде непрерывного усреднения реализации процесса на некотором временном 
интервале, длительностью $T$, примыкающем к текущему моменту времени $t$:
\begin{equation}
    \label{eq:1.3}
    \tilde x(t) = \frac{1}{T} \int\limits_{t-T}^{t} x(\tilde t) \dd{\tilde t} 
\end{equation}

В связи с тем, что при использовании численных методов сам интеграл в \eqref{eq:1.3}
вычисляется приближенно через значения подынтегральной функции в отдельных дискретных точках. Оценку 
\eqref{eq:1.3}  можно рассматривать как частный случай оценки \eqref{eq:1.2},
если отсчеты берутся достаточно часто (если интервал между отсчетами существенно меньше 
времени корреляции процесса $\Delta t \ll \tau_{\text{кор}}$). Тем не менее, имеет смысл
рассмотреть аналитически [1] оценку среднего в виде (1.3) и убедиться в том, что величина
погрешности оценки определяется лишь числом некоррелированных отсчетов содержащихся в 
интервале усреднения $T$.
Другими словами, если в оценке \eqref{eq:1.1}  взято $n$ некоррелированных отсчетов, а в
оценке \eqref{eq:1.3}  интервал усреднения $T$ выбран равным $T = n \tau_{\text{кор}}$,
оценки \eqref{eq:1.1}  и \eqref{eq:1.3}  оказываются эквивалентными по точности при $n\gg 1$. Следует проследить за выполнением этого утверждения при выполнении заданий №3,5.

\section{Погрешность оценки}%
\label{sec:pogreshnost_otsenki}
На практике важно не просто получить оценку параметра, но и оценить, как близко значение оценки к истинному значению параметра. Другими словами, необходимо оценить погрешность оценки. Поскольку конкретное значение оценки параметра случайно (оно определяется конкретной выборкой $x_{1},x_{2},\dots,x_n$), то и ошибка конкретной оценки тоже случайна. Поэтому при рассмотрении погрешности оценки имеется в виду рассмотреть ее поведение на ансамбле независимых замеров оценки.

За погрешность оценки принимаем среднеквадратическое отклонение оценки от среднего
значения (корень квадратный из дисперсии оценки), т.е.
\begin{equation}
    \label{eq:2.1}
    \sigma_{\tilde x} = \sqrt{ D\qty[\tilde x]} = \sqrt{ \mean{(\tilde x - \mean{x})^2} }
\end{equation}
или средний квадрат отклонения от истинного среднего. С.К.О. оценки показывают в каком интервале
лежат оценки среднего.

В предельном случае при $n=1$, (производится \textbf{однократный отсчёт}), и результат $x_{1}$ принимается за оценку среднего), ошибка конкретной оценки  $(x_{1}-\mean{x})$ естественно будет случайной,
а погрешность оценки:
\begin{equation}
    \label{eq:2.2}
    \sqrt{ \mean{ \qty( x_{1} - \mean{x} )^2 } } = \sqrt{D\qty[x]} = \sigma_x
\end{equation}

Из \eqref{eq:2.2} видно, что мерой погрешности оценки при $n=1$ является 
среднеквадратическое отклонение (СКО) исследуемой случайной величины (корень квадратный из дисперсии
исходного процесса в случае \eqref{eq:1.1} ).

Известно, что при усреднении <<$n$>> независимых одинаково распределенных
слагаемых дисперсия уменьшается в $n$ раз
\begin{equation}
    \label{eq:2.3}
    \sigma_{\tilde x} = \sqrt{ \frac{D\qty[x] }{n}}
\end{equation}

Если же оценивается среднее значение эргодического процесса, согласно алгоритму
\eqref{eq:1.2}, дисперсию оценки $D\qty[\tilde x] = \mean{ \qty( \tilde x - \mean{x} )^2 }$
можно записать [1] в виде
\begin{equation}
    \label{eq:2.4}
    D\qty[\tilde x] = \frac{\D{x}}{n} + \frac{1}{n^2} \sum\limits_{i=1}^{n} \sum\limits_{j\neq i}^{n} B_x(t_i - t_j),
\end{equation}
где $B_x(t_i - t_j) = \mean{ (x_i - \mean{x}) (x_i - \mean{x})  }$ -- функция
ковариации процесса  $x(t)$, причем $\D{x}$ -- дисперсия процесса $x(t)$ -
равна $\D{x}=B_x(0)$.

При $n \to \infty$ дисперсия оценки стремится к нулю $\D{\tilde x} \to 0$, т.е.
оценка является \textbf{состоятельной}.

Из \eqref{eq:2.4} видно, что величина $\D{\tilde x}$ дисперсии оценки \eqref{eq:1.2} 
существенно зависит от степени коррелированности отсчетов, а значит от того, насколько
велик интервал между отсчетами $\Delta t$ по сравнению с $\tau_{\text{кор}}$ - временем
корреляции процесса ( $t_{\text{кор}}$ -- эффективная протяженность $B_x(\tau)$ - 
функции ковариации процесса $x(t)$ ).


Здесь есть две предельные ситуации:
\begin{enumerate}
    \item Все $n$ отсчетов укладываются на времени, существенно меньшем времени корреляции
        процесса ($n\cdot \Delta t \ll \tau_{\text{кор}}$), тогда дисперсия оценки равна
        дисперсии исходного процесса $\D{\tilde x}= \D{x}$. В этом случае <<n>> отсчетов
        по влиянию на точность оценки эквивалентны одному отсчету.
    \item  Если же $\Delta t \geq \tau_{\text{кор}}$, то можно принять  и дисперсия оценки \eqref{eq:1.2} 
        оказывается равной, т.е. дисперсия оценки аналогично \eqref{eq:2.3}  в <<n>> раз уменьшается по сравнению с дисперсией процесса, где <<n>> ‑ число некоррелированных отсчетов в оценке \eqref{eq:1.2} .

Поведение СКО оценки при произвольных $\Delta t$ исследуется в заданиях №№ 3, 4.
\end{enumerate}


\section{Оценка среднего значения и погрешности оценки среднего при помощи спектральной 
плотности мощности}%

Как уже рассматривалось выше, если $x(t)$ -- случайный эргодический процесс, то среднее
$\mean{x}$ может быть найдено путем усреднения по времени в виде \eqref{eq:1.3}.

Корреляционная функция процесса $x(t)$ :
\begin{equation}
    \label{eq:}
    K_x\qty[\tau] = B_x[\tau] + \mean{x}^2,
\end{equation}
а спектральная плотность мощности:
\begin{equation}
    \label{eq:}
    S_x(\omega) = S_{x-\mean{x}}(\omega) + 2 \pi \delta(\omega) \mean{x}^2.
\end{equation}
Т.е. в случае ненулевого среднего значения в спектре случайного процесса наблюдается $\delta$ - 
функция на нулевой частоте, а дисперсия представляет собой площадь под непрерывной частью спектра.

Оценку среднего значения процесса в виде \eqref{eq:1.3}  можно рассматривать, как некоторый новый процесс,
полученный из исходного путем линейного преобразования. В задании №5 рассматривается спектральная плотность мощности  оценки  в виде \eqref{eq:1.3} . Как найти по  погрешность оценки \eqref{eq:1.3}. Исследовать, как изменяется  с увеличением времени усреднения $T$, за счет чего при этом уменьшается погрешность оценки среднего.
Для объяснения результатов этого задания, необходимо иметь в виду, что спектральная плотность мощности оценки среднего значения в виде \eqref{eq:1.3} , т.е. $S_{\tilde x}(\omega)$, связана со спектральной плотностью мощности исходного процесса $S_x(\omega)$  соотношением
\begin{equation}
    \label{eq:4.1}
    S_{\tilde x}(2 \pi f) = S_x(2 \pi f) \abs{K(j 2 \pi f)}^2
\end{equation}

Коэффициент передачи  $K(j 2 \pi f)$ линейного преобразования \eqref{eq:1.3}  можно найти, как комплексную амплитуду выходного гармонического колебания, если же вместо входного 
процесса  $\tilde x(t)$ в \eqref{eq:1.3}  подставить $e^{j 2 \pi f t}$ (гармоническое колебание единичной амплитуды и частоты $2 \pi f$). При этом окажется, что 
\begin{equation}
    \label{eq:4.2}
    \abs{K(j_{2} \pi f)}^2 = \abs{\frac{\sin{\pi f T}}{\pi f T}}^2
\end{equation}

Из \eqref{eq:4.2}  видно, что усреднитель \eqref{eq:1.3} действует как фильтр,
пропускающий спектральные составляющие в эффективной полосе $\Delta f_x = \frac{1}{2T}$,
примыкающей к $f=0$. Постоянная составляющая, а также $S_{\tilde x}(0)$ спектральная плотность
мозности процесса $\tilde x(t)$ на нулевой частоте, при этом остаются неизменными, т.к.
$K(j 2 \pi f) \eval_{f=0}=1$. С увеличением $T$, уменьшается полоса пропускания этого фильтра,
а значит и $\D{\tilde x}$ -- дисперсии оценки \eqref{eq:1.3},
приближенно равная $\D{\tilde x}=S_{\tilde x}(0)\cdot \Delta f_{\tilde x} = S_{\tilde x}(0) \frac{1}{2T}$.

При выполнении задания №5 следует убедиться, что $\D{\tilde x} = \frac{\D{x}}{T / \tau_{\text{кор}}}$, (при $T\gg \tau_{\text{кор}}$ ), т.е.
погрешность оценки \eqref{eq:1.3} определяется только числом некоррелированных отсчетов,
содержащихся в интервале усреднения $T$.

В этом задании следует получить так же оценку среднего значения и оценить ее 
погрешность непосредственно по спектральной плотности мощности процесса $\tilde x(t)$. 
Эта оценка оказывается по существу эквивалентной оценке \eqref{eq:1.3}  при времени усреднения $T$,
равном тому временному интервалу $T^*$, на котором мы находим Фурье-преобразование процесса 
(в нашем случае $T^*=2048$); а ширина спектральной плотности мощности оценки, определяющая 
ее дисперсию, обратна длине этого интервала и равна $1/2048$ (по существу это ширина 
интервала частотного разрешения в спектре при выбранных параметрах Фурье-преобразования).

\section{Доверительный интервал и доверительная вероятность}%
\label{sec:doveritel_nyi_interval_i_doveritel_naia_veroiatnost_}
Выше за количественную характеристику погрешности оценки среднего значения было взято СКО 
оценки (корень квадратный из дисперсии оценки). Но в связи с тем, что оценка является 
случайной величиной, определяемой случайными выборочными значениями $x_1,x_2,\dots,x_n$,
на практике возможна реализация таких значений оценки, которые отличаются от истинного
значения среднего больше, чем на величину СКО оценки. Как часто это может происходить, и
какой должна быть выбрана длина интервала, характеризующего погрешность оценки, чтобы с
достоверностью неизвестное среднее отстояло от случайной оценки не дальше, чем на величину 
выбранного интервала? Сначала несколько слов о том, что значит с достоверностью? При какой 
вероятности появление события его можно считать практически достоверным? Эта вероятность 
определяется существом исходной задачи. В некоторых задачах это может быть $0.90$ или $0.95$; $0.99$ и т.д. Эту вероятность будем называть доверительной и обозначать $\beta$. 
По этой вероятности выбирается $I_{\beta}$ величина интервала, называемого доверительным 
(обычно его длина выражается в долях среднеквадратического значения оценки $I_{\beta}=t_{\beta} \sigma_{{\tilde x}}$). 
Если отложить этот интервал вокруг случайного значения оценки, то он с доверительной 
вероятностью $\beta$ накроет неизвестное среднее значение $\mean{x}$ (т.е. практически с достоверностью).

Величина доверительного интервала выражается через плотность вероятностного распределения о
оценки $W(\tilde x)$ и доверительную вероятность $\beta$ согласно соотношению:
\begin{equation}
    \label{eq:5.1}
    P\qty(\abs{\mean{x}} - \tilde x \leq I_{\beta}) = \int\limits_{\mean{x}-I_{\beta}}^{\mean{x}+I_{\beta}}  W(\tilde x) \dd{\tilde x} = \beta
\end{equation}

В значительном ряде случаев принимается, что плотность вероятности оценки  $W(\tilde x)$ распределена по закону Гаусса (по закону Гаусса зачастую распределена и сама величина $X$,
среднее значение которой оценивается, но если $X$ не имеет гауссова распределения, то 
можно принять распределенной по закону Гаусса саму оценку $\tilde x$  при достаточно большом числе 
усредняемых некоррелированных слагаемых в \eqref{eq:1.1}  в силу центральной предельной теоремы теории вероятностей).
При небольших $n$ ($n\leq 15$ ) распределение оценки $\tilde x$ нельзя считать 
Гауссовым даже в том случае, когда $X$ -- распределено по закону Гаусса, если 
неизвестна дисперсия величины $X$ и она оценивается по тем же <<n>> отсчетам. 
Подробнее об этом сказано в примечании к заданию №6. 
В этом случае следует находить доверительный интервал для оценки, считая, что относительная величина оценки $\frac{\tilde x}{\sigma_{\tilde x}}$ распределена по
закону Стьюдента с числом степеней свободы равным <<n-1>> (где $n$ -- число 
усредняемых некоррелированных отсчетов в оценке \eqref{eq:1.1}  и, пользуясь соответствующими таблицами, имеющимися в справочной литературе).

Вопросы, связанные с описание погрешности оценки через доверительный интервал и доверительную вероятность, рассматриваются в задани  №6.
\end{document}
